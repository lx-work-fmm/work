<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RFTester &mdash; ttest 1.0 文档</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/translations.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            ttest
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"></div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ttest</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">模块代码</a></li>
      <li class="breadcrumb-item active">RFTester</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>RFTester 源代码</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyvisa</span>
<span class="n">rm</span> <span class="o">=</span> <span class="n">pyvisa</span><span class="o">.</span><span class="n">ResourceManager</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rm</span><span class="p">)</span>

<div class="viewcode-block" id="Instrument"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument">[文档]</a><span class="k">class</span> <span class="nc">Instrument</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    仪器类</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Instrument.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        type:</span>
<span class="sd">            N5183B - 信号发生器</span>
<span class="sd">            N9010B - 频谱仪</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="Instrument.connect"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.connect">[文档]</a>    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        :return:</span>
<span class="sd">            0 -&gt; success</span>
<span class="sd">            1 -&gt; Fail to open</span>
<span class="sd">            2 -&gt; not founded</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">res_list</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">list_resources</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">res_list</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">res_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">rm</span><span class="o">.</span><span class="n">open_resource</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">read_termination</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="c1"># self.h.write_termination = &#39;\n&#39;</span>
                    <span class="nb">print</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fail to open Instrument </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="mi">1</span>
                    <span class="c1"># raise Exception(f&#39;Fail to open Instrument {self.type}&#39;) </span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_connected</span><span class="p">():</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">2</span></div>
        
<div class="viewcode-block" id="Instrument.is_connected"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.is_connected">[文档]</a>    <span class="k">def</span> <span class="nf">is_connected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;*IDN?&#39;</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>
    
<div class="viewcode-block" id="Instrument.test_connection_or_reconnect"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.test_connection_or_reconnect">[文档]</a>    <span class="k">def</span> <span class="nf">test_connection_or_reconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;try to connect?&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Instrument </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> not connected&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">YES_DEFAULT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span><span class="p">)</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">YES</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_connection_or_reconnect</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Instrument </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> not connected&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>
    
<div class="viewcode-block" id="Instrument.write"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.write">[文档]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Instrument.query"><a class="viewcode-back" href="../RFTester.html#RFTester.Instrument.query">[文档]</a>    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cmd</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span></div></div>
    
<span class="c1"># 信号发生器</span>
<div class="viewcode-block" id="Source"><a class="viewcode-back" href="../RFTester.html#RFTester.Source">[文档]</a><span class="k">class</span> <span class="nc">Source</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># 192.168.1.100</span>
<div class="viewcode-block" id="Source.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.Source.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;N5183B&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span></div>
        <span class="c1"># print(&#39;[src freq]&#39;)</span>
        <span class="c1"># print(&#39;center:&#39;, self.query(&#39;:FREQ:CENT?&#39;))</span>
        <span class="c1"># print(&#39;center min:&#39;, self.query(&#39;:FREQ:CENT? MIN&#39;))</span>
        <span class="c1"># print(&#39;center max:&#39;, self.query(&#39;:FREQ:CENT? MAX&#39;))</span>
        <span class="c1"># print(&#39;mode:&#39;, self.query(&#39;:FREQ:MODE?&#39;))</span>
        <span class="c1"># print(&#39;ref:&#39;, self.query(&#39;:FREQ:REF?&#39;))</span>
        <span class="c1"># print(&#39;ref stat:&#39;, self.query(&#39;:FREQ:REF:STAT?&#39;))</span>
        <span class="c1"># print(&#39;offset stat:&#39;, self.query(&#39;:FREQ:OFFS?&#39;))</span>
        <span class="c1"># print(&#39;offset stat:&#39;, self.query(&#39;:FREQ:OFFS:STAT?&#39;))</span>
        <span class="c1"># print(&#39;multiplier:&#39;, self.query(&#39;:FREQ:MULT?&#39;))</span>
        <span class="c1"># print(&#39;fiexd:&#39;, self.query(&#39;:FREQ:FIX?&#39;))</span>
        <span class="c1"># print(&#39;[src amp]&#39;)</span>
        <span class="c1"># print(&#39;state:&#39;, self.query(&#39;:MARK:AMPL?&#39;))</span>
        <span class="c1"># print(&#39;value:&#39;, self.query(&#39;:MARK:AMPL:VAL?&#39;))</span>
        <span class="c1"># print(&#39;[src output]&#39;)</span>
        <span class="c1"># print(&#39;MOD:&#39;, self.query(&#39;:OUTP:MOD:STAT?&#39;))</span>
        <span class="c1"># print(&#39;RF:&#39;, self.query(&#39;:OUTP:STAT?&#39;))</span>
        <span class="c1"># print(&#39;[src source]&#39;)</span>
        <span class="c1"># print(&#39;power reference:&#39;, self.query(&#39;:SOUR:POW:REF?&#39;))</span>
        <span class="c1"># print(&#39;power reference stat:&#39;, self.query(&#39;:SOUR:POW:REF:STAT?&#39;))</span>
        <span class="c1"># print(&#39;power start:&#39;, self.query(&#39;:SOUR:POW:STAR?&#39;))</span>
        <span class="c1"># print(&#39;power stop:&#39;, self.query(&#39;:SOUR:POW:STOP?&#39;))</span>
        <span class="c1"># print(&#39;power level immediate amplitude:&#39;, self.query(&#39;:SOUR:POW:LEV:IMM:AMPL?&#39;)) # 或 POW?</span>
        
        
<div class="viewcode-block" id="Source.test"><a class="viewcode-back" href="../RFTester.html#RFTester.Source.test">[文档]</a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.write(&#39;:FREQuency:REFerence 5GHz&#39;)</span>
        <span class="c1"># self.write(&#39;:FREQuency 2GHz&#39;)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:FIXed?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:REFerence?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:START?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:STOP?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:SPAN?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:LSPurs:STATe?&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;:FREQuency:MODE?&#39;</span><span class="p">))</span></div></div>

<span class="c1"># 频谱仪</span>
<div class="viewcode-block" id="Spectrum"><a class="viewcode-back" href="../RFTester.html#RFTester.Spectrum">[文档]</a><span class="k">class</span> <span class="nc">Spectrum</span><span class="p">(</span><span class="n">Instrument</span><span class="p">):</span>
    <span class="c1"># 192.168.31.102</span>
<div class="viewcode-block" id="Spectrum.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.Spectrum.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;N9010B&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">type</span><span class="p">)</span></div>
        <span class="c1"># print(&#39;spec&#39;)</span>
    
<div class="viewcode-block" id="Spectrum.set_freq"><a class="viewcode-back" href="../RFTester.html#RFTester.Spectrum.set_freq">[文档]</a>    <span class="k">def</span> <span class="nf">set_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freq</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CALC:MARK1:X </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">GHz&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Spectrum.read"><a class="viewcode-back" href="../RFTester.html#RFTester.Spectrum.read">[文档]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CALC:MARK1:Y?&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Spectrum.test"><a class="viewcode-back" href="../RFTester.html#RFTester.Spectrum.test">[文档]</a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div></div>

<span class="kn">import</span> <span class="nn">wx</span>

<div class="viewcode-block" id="InputText"><a class="viewcode-back" href="../RFTester.html#RFTester.InputText">[文档]</a><span class="k">class</span> <span class="nc">InputText</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>
<div class="viewcode-block" id="InputText.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.InputText.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">st</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_RICH2</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">st</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="InputText.getValue"><a class="viewcode-back" href="../RFTester.html#RFTester.InputText.getValue">[文档]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span></div></div>

<div class="viewcode-block" id="PathSelector"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector">[文档]</a><span class="k">class</span> <span class="nc">PathSelector</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>
<div class="viewcode-block" id="PathSelector.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">wx</span><span class="o">.</span><span class="n">Window</span><span class="p">,</span> <span class="n">file_or_dir</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        file_or_dir</span>
<span class="sd">            0 -&gt; file</span>
<span class="sd">            1 -&gt; dir</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">=</span> <span class="n">file_or_dir</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_select</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_RICH2</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">value</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_RICH2</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_CENTER</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span><span class="o">.</span><span class="n">SetStyle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_select</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;select a file&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_select</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">label</span> <span class="ow">or</span> <span class="s1">&#39;选择文件&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">DirDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;select a directory&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_select</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">label</span> <span class="ow">or</span> <span class="s1">&#39;选择目录&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;file_or_dir = 0 | 1, not </span><span class="si">{</span><span class="n">file_or_dir</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># self.flag_error_path = True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_tc_change</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">BindEvents</span><span class="p">()</span></div>
        
<div class="viewcode-block" id="PathSelector.BindEvents"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector.BindEvents">[文档]</a>    <span class="k">def</span> <span class="nf">BindEvents</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_btn_click</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">btn_select</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_tc_change</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span> <span class="p">)</span></div>
    
<div class="viewcode-block" id="PathSelector.on_btn_click"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector.on_btn_click">[文档]</a>    <span class="k">def</span> <span class="nf">on_btn_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">())</span></div>
            <span class="c1"># self.tc.SetToolTip(self.dlg.GetPath())</span>
    
<div class="viewcode-block" id="PathSelector.on_tc_change"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector.on_tc_change">[文档]</a>    <span class="k">def</span> <span class="nf">on_tc_change</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
        <span class="c1"># print(self.tc.MinWidth, self.tc.CharWidth*len(self.tc.Value))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">MinWidth</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">CharWidth</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">SetToolTip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">UnsetToolTip</span><span class="p">()</span>
        
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="ow">or</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span><span class="o">.</span><span class="n">SetStyle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_error_path</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span><span class="o">.</span><span class="n">SetStyle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_error_path</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span> <span class="ow">or</span> \
            <span class="bp">self</span><span class="o">.</span><span class="n">file_or_dir</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tc_err</span><span class="o">.</span><span class="n">SetStyle</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">TextAttr</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;white&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_error_path</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PathSelector.getValue"><a class="viewcode-back" href="../RFTester.html#RFTester.PathSelector.getValue">[文档]</a>    <span class="k">def</span> <span class="nf">getValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span></div></div>
    
<div class="viewcode-block" id="MainFrame"><a class="viewcode-back" href="../RFTester.html#RFTester.MainFrame">[文档]</a><span class="k">class</span> <span class="nc">MainFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
<div class="viewcode-block" id="MainFrame.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.MainFrame.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;RFTester&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="n">pnl</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">gbs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">GridBagSizer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">it_start</span> <span class="o">=</span> <span class="n">InputText</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="s1">&#39;Start(GHz):&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_stop</span> <span class="o">=</span> <span class="n">InputText</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="s1">&#39;Stop(GHz):&#39;</span><span class="p">,</span> <span class="s1">&#39;6&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_point</span> <span class="o">=</span> <span class="n">InputText</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="s1">&#39;Point:&#39;</span><span class="p">,</span> <span class="s1">&#39;5&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_amp</span> <span class="o">=</span> <span class="n">InputText</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="s1">&#39;Amplitude(dBm):&#39;</span><span class="p">,</span> <span class="s1">&#39;-20&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ps</span> <span class="o">=</span> <span class="n">PathSelector</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;选择输出文件&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;C:\Users\Administrator\Desktop\test.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_delay</span> <span class="o">=</span> <span class="n">InputText</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="s1">&#39;Test Delay(s):&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_start</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">pnl</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Start Test&#39;</span><span class="p">)</span>
        
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it_start</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it_stop</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it_point</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it_amp</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">it_delay</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ps</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">span</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_start</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">flag</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">pnl</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">gbs</span><span class="p">)</span>
        
        <span class="c1"># gbs.Fit(pnl)</span>
        <span class="n">gbs</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="MainFrame.testing"><a class="viewcode-back" href="../RFTester.html#RFTester.MainFrame.testing">[文档]</a>    <span class="k">def</span> <span class="nf">testing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_start</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s1">&#39;Stop&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">btn_start</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s1">&#39;Start Test&#39;</span><span class="p">)</span>
        
        <span class="n">flag</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">flag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_start</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_stop</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_point</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">it_amp</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span></div></div>
        <span class="c1"># self.ps.Enable(flag)</span>
    
        
<div class="viewcode-block" id="Main"><a class="viewcode-back" href="../RFTester.html#RFTester.Main">[文档]</a><span class="k">class</span> <span class="nc">Main</span><span class="p">():</span>
<div class="viewcode-block" id="Main.__init__"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.__init__">[文档]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">App</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span> <span class="o">=</span> <span class="n">MainFrame</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">Source</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span> <span class="o">=</span> <span class="n">Spectrum</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind_Events</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        <span class="n">app</span><span class="o">.</span><span class="n">MainLoop</span><span class="p">()</span></div>
        
    
<div class="viewcode-block" id="Main.Bind_Events"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.Bind_Events">[文档]</a>    <span class="k">def</span> <span class="nf">Bind_Events</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_start_or_stop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">btn_start</span><span class="p">)</span></div>
        <span class="c1"># self.view.Bind(wx.EVT_BUTTON, lambda e: print(111), self.view.ps.btn_select)</span>
    
<div class="viewcode-block" id="Main.on_start_or_stop"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.on_start_or_stop">[文档]</a>    <span class="k">def</span> <span class="nf">on_start_or_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">threading</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">test</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Main.test"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.test">[文档]</a>    <span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_start</span><span class="o">.</span><span class="n">getValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_stop</span><span class="o">.</span><span class="n">getValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_point</span><span class="o">.</span><span class="n">getValue</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
        <span class="kn">import</span> <span class="nn">os</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">flag_error_path</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s1">&quot; is not a file path&#39;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_start</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_stop</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
            <span class="n">point</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_point</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
            <span class="n">amp</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_amp</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
            <span class="n">delay</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_delay</span><span class="o">.</span><span class="n">getValue</span><span class="p">())</span>
            <span class="n">out_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">getValue</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s2">&quot;类型错误&quot;</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span>
        
        <span class="c1"># self.flag_testing = True</span>
        <span class="c1"># self.view.testing(True)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">test_core</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">out_file</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">testing</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Main.test_core"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.test_core">[文档]</a>    <span class="k">def</span> <span class="nf">test_core</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">out_file</span> <span class="o">=</span> <span class="s1">&#39;./output.csv&#39;</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;start test...&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">test_connection_or_reconnect</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">is_connected</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">test_connection_or_reconnect</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">point</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># (1) 配置信号发生器</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;FREQ:REF:STAT OFF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;FREQ:OFFS:STAT OFF&#39;</span><span class="p">)</span>
        <span class="c1"># 关 MODulation, 开 RF</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;OUTP:MOD:STAT OFF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;OUTP:STAT ON&#39;</span><span class="p">)</span>
        <span class="c1"># 设置 amp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SOUR:POW </span><span class="si">{</span><span class="n">amp</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">it_amp</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;SOUR:POW?&#39;</span><span class="p">))))</span>
        
        
        <span class="c1"># (2) 配置频谱仪</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;pre:: start: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SENS:FREQ:STAR?&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">, stop: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SENS:FREQ:STOP?&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SENS:FREQ:STAR </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s1">GHz&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SENS:FREQ:STOP </span><span class="si">{</span><span class="n">stop</span><span class="si">}</span><span class="s1">GHz&#39;</span><span class="p">)</span>
        <span class="c1"># self.spec.write(f&#39;SENS:FREQ:CENT {6}GHz&#39;)</span>
        <span class="c1"># self.spec.write(f&#39;SENS:FREQ:SPAN {10}GHz&#39;)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;now:: start: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SENS:FREQ:STAR?&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">, stop: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;SENS:FREQ:STOP?&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># print(self.spec.query(&quot;SENS:FREQ:CENT?&quot;), self.spec.query(&quot;SENS:FREQ:SPAN?&quot;))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CALC:MARK1:STAT OFF&#39;</span><span class="p">)</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;CALC:MARK1:X?&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;CALC:MARK1:Y?&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_testing</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;manual stop...&#39;</span><span class="p">)</span>
                <span class="k">return</span>
            
            <span class="kn">import</span> <span class="nn">time</span>
            
            <span class="c1"># () 发信号</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;:FREQuency </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">GHz&#39;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
            
            <span class="c1"># () 收信号</span>
            <span class="c1"># self.spec.write(f&#39;CALC:MARK1:X {freq}GHz&#39;)</span>
            <span class="c1"># # print(self.spec.query(f&#39;CALC:MARK1:FUNC:EXEC?&#39;))</span>
            <span class="c1"># ret = float(self.spec.query(f&#39;CALC:MARK1:Y?&#39;))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;CALC:MARK1:MAX&#39;</span><span class="p">)</span>
            <span class="c1"># time.sleep(delay)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;CALC:MARK1:X?&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;CALC:MARK1:Y?&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CALC:MARK1:X </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1">GHz&#39;</span><span class="p">)</span>
            <span class="n">y1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;CALC:MARK1:Y?&#39;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="c1"># res.append([freq, y1, x, y])</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">freq</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
        <span class="kn">import</span> <span class="nn">csv</span>
        <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">out_file</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">out_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ICON_INFORMATION</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageBox</span><span class="p">(</span><span class="s1">&#39;change path and try again?&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s1">&#39;save error&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">YES_NO</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">YES_DEFAULT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ICON_WARNING</span><span class="p">)</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">YES</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">on_btn_click</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">ps</span><span class="o">.</span><span class="n">tc</span><span class="o">.</span><span class="n">Value</span><span class="p">)</span>
        <span class="n">save</span><span class="p">(</span><span class="n">out_file</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Main.debug"><a class="viewcode-back" href="../RFTester.html#RFTester.Main.debug">[文档]</a>    <span class="k">def</span> <span class="nf">debug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">test</span><span class="p">()</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">DEBUG</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># Main().debug()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">rm</span><span class="o">.</span><span class="n">list_resources</span><span class="p">())</span>
        
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Main</span><span class="p">()</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2024, lx.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>